<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ªç¨è®¡ç®—å™¨ - 2025ç‰ˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 900px;
            width: 100%;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            align-items: stretch;
        }

        .input-section {
            padding: 30px;
            background: #f8f9fa;
            border-right: 1px solid #e0e0e0;
            position: relative;
        }

        .result-section {
            padding: 30px;
            background: white;
        }

        @media (max-width: 768px) {
            .content {
                grid-template-columns: 1fr;
            }

            .input-section {
                border-right: none;
                border-bottom: 1px solid #e0e0e0;
            }
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group small {
            display: block;
            margin-top: 5px;
            color: #666;
            font-size: 12px;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            font-weight: normal;
        }

        .radio-group input[type="radio"] {
            width: auto;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: "";
            width: 4px;
            height: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 2px;
        }

        .btn-reset {
            width: 100%;
            padding: 12px;
            background: #6c757d;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
        }

        .btn-reset:hover {
            background: #5a6268;
        }

        .btn-calculate {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-calculate:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-calculate:active {
            transform: translateY(0);
        }

        .result-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .result-card .label {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .result-card .value {
            font-size: 42px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .result-card .unit {
            font-size: 16px;
            opacity: 0.8;
        }

        .detail-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        .detail-item:last-child {
            border-bottom: none;
        }

        .detail-item .label {
            color: #666;
            font-size: 14px;
        }

        .detail-item .value {
            font-weight: 600;
            color: #333;
            font-size: 16px;
        }

        .detail-item.total {
            background: #f0f0f0;
            margin: 0 -30px;
            padding: 15px 30px;
            border-top: 2px solid #ddd;
            border-bottom: none;
        }

        .detail-item.total .label {
            color: #333;
            font-weight: 600;
        }

        .detail-item.total .value {
            color: #667eea;
            font-size: 20px;
        }

        .detail-item.total-highlight {
            background: #f0f0f0;
            margin: 0 -30px;
            padding: 15px 30px;
            border-top: 2px solid #ddd;
            border-bottom: none;
        }

        .detail-item.total-highlight .label {
            color: #333;
            font-weight: 600;
        }

        .detail-item.total-highlight .value {
            color: #e91e63;
            font-size: 20px;
        }

        .detail-item.total-year-amount {
            background: #f0f0f0;
            margin: 0 -30px;
            padding: 15px 30px;
            border-top: 2px solid #ddd;
            border-bottom: none;
        }

        .detail-item.total-year-amount .label {
            color: #333;
            font-weight: 600;
        }

        .detail-item.total-year-amount .value {
            color: #9b59b6;
            font-size: 20px;
        }

        .effective-rate {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 8px;
            padding: 12px;
            margin-top: 15px;
            text-align: center;
        }

        .effective-rate .rate {
            font-size: 24px;
            font-weight: bold;
            color: #856404;
        }

        .effective-rate .text {
            font-size: 12px;
            color: #856404;
            margin-top: 5px;
        }

        .deduction-item {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 10px;
        }

        .deduction-field {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .deduction-field .field-label {
            white-space: nowrap;
            font-size: 13px;
            color: #555;
            font-weight: 500;
        }

        .deduction-field input {
            width: 100%;
            padding: 10px;
            font-size: 14px;
        }

        .deduction-hint {
            font-size: 11px;
            color: #999;
            margin-top: 2px;
            line-height: 1.4;
        }

        .deduction-field-wrapper {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .warning-alert {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-left: 4px solid #ffc107;
            border-radius: 8px;
            padding: 12px 15px;
            margin-top: 15px;
            visibility: hidden;
            opacity: 0;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .warning-alert.show {
            visibility: visible;
            opacity: 1;
        }

        .warning-alert .warning-title {
            color: #856404;
            font-weight: 600;
            font-size: 14px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .warning-alert .warning-text {
            color: #856404;
            font-size: 13px;
            line-height: 1.5;
        }

        .form-group input:disabled {
            background-color: #f5f5f5;
            color: #666;
            cursor: not-allowed;
        }

        .form-group input:disabled::placeholder {
            color: #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ’° ä¸ªç¨è®¡ç®—å™¨ - 2025ç‰ˆ</h1>
            <p>æ”¯æŒ2025å¹´æœ€æ–°ä¸ªç¨æ”¿ç­– | èµ·å¾ç‚¹5000å…ƒ/æœˆ</p>
        </div>

        <div class="content">
            <div class="input-section">
                <h2 class="section-title">æ”¶å…¥ä¿¡æ¯</h2>

                <div class="radio-group">
                    <label>
                        <input type="radio" name="salaryType" value="month" checked onchange="toggleSalaryType()">
                        æŒ‰æœˆè®¡ç®—
                    </label>
                    <label>
                        <input type="radio" name="salaryType" value="year" onchange="toggleSalaryType()">
                        æŒ‰å¹´è®¡ç®—
                    </label>
                </div>

                <div class="form-group">
                    <label>å½“å‰è®¡ç®—æœˆä»½</label>
                    <select id="currentMonth" onchange="calculate()" style="width: 100%; padding: 12px 15px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 16px;">
                        <option value="1">1æœˆ</option>
                        <option value="2">2æœˆ</option>
                        <option value="3">3æœˆ</option>
                        <option value="4">4æœˆ</option>
                        <option value="5">5æœˆ</option>
                        <option value="6">6æœˆ</option>
                        <option value="7">7æœˆ</option>
                        <option value="8">8æœˆ</option>
                        <option value="9">9æœˆ</option>
                        <option value="10">10æœˆ</option>
                        <option value="11">11æœˆ</option>
                        <option value="12" selected>12æœˆ</option>
                    </select>
                    <small>ç”¨äºè®¡ç®—ç´¯è®¡é¢„æ‰£é¢„ç¼´ä¸ªç¨</small>
                </div>

                <div class="form-group" id="monthSalaryGroup">
                    <label>ç¨å‰æœˆè–ª</label>
                    <input type="number" id="monthlySalary" placeholder="è¯·è¾“å…¥æœˆè–ª" value="0" onchange="calculate()">
                </div>

                <div class="form-group" id="yearSalaryGroup" style="display: none;">
                    <label>ç¨å‰å¹´è–ª</label>
                    <input type="number" id="yearlySalary" placeholder="è¯·è¾“å…¥å¹´è–ª" onchange="calculate()">
                </div>

                <h2 class="section-title">äº”é™©ä¸€é‡‘</h2>

                <div class="form-group">
                    <label>ç¤¾ä¿ç¼´è´¹åŸºæ•°</label>
                    <input type="number" id="socialBase" placeholder="é»˜è®¤ç­‰äºæœˆè–ª" onchange="calculate()">
                    <small>ç•™ç©ºåˆ™ç­‰äºæœˆè–ª</small>
                </div>

                <div class="form-group">
                    <label>å…¬ç§¯é‡‘æ¯”ä¾‹ï¼ˆä¸ªäººéƒ¨åˆ†ï¼‰</label>
                    <input type="number" id="fundRate" placeholder="5-12" value="12" min="5" max="12" step="1" onchange="calculate()">
                    <small>ä¸ªäººç¼´å­˜æ¯”ä¾‹ï¼ŒèŒƒå›´5%-12%</small>
                </div>

                <div class="form-group">
                    <label>å…¬ç§¯é‡‘ç¼´è´¹åŸºæ•°</label>
                    <input type="number" id="fundBase" placeholder="é»˜è®¤ç­‰äºç¤¾ä¿åŸºæ•°" onchange="calculate()">
                    <small>ç•™ç©ºåˆ™ç­‰äºç¤¾ä¿åŸºæ•°</small>
                </div>

                <h2 class="section-title">å…¶ä»–æ”¶å…¥</h2>

                <div class="form-group">
                    <label>ğŸ’° å¹´ç»ˆå¥–</label>
                    <input type="number" id="yearEndBonus" placeholder="è¯·è¾“å…¥å¹´ç»ˆå¥–é‡‘é¢" value="0" onchange="calculate()">
                    <small>å…¨å¹´ä¸€æ¬¡æ€§å¥–é‡‘ï¼Œå¯ç©º</small>
                </div>

                <div class="form-group">
                    <label>å¹´ç»ˆå¥–è®¡ç¨æ–¹å¼</label>
                    <div class="radio-group">
                        <label>
                            <input type="radio" name="bonusTaxMethod" value="separate" checked onchange="calculate()">
                            å•ç‹¬è®¡ç¨
                        </label>
                        <label>
                            <input type="radio" name="bonusTaxMethod" value="combined" onchange="calculate()">
                            å¹¶å…¥ç»¼åˆæ‰€å¾—
                        </label>
                    </div>
                    <small>å•ç‹¬è®¡ç¨æ›´ä¼˜æƒ ï¼Œä½†é€‰æ‹©åä¸€å¹´å†…ä¸å¾—å˜æ›´</small>
                </div>

                <div class="form-group">
                    <label>ğŸ“‹ åŠ³åŠ¡æŠ¥é…¬æ€»é¢ï¼ˆå…ƒ/å¹´ï¼‰</label>
                    <input type="number" id="laborIncome" placeholder="è¯·è¾“å…¥å…¨å¹´åŠ³åŠ¡æŠ¥é…¬æ€»é¢" oninput="onLaborTotalChange()">
                    <small>å¡«å†™æ€»é¢åï¼Œæ¯æœˆåŠ³åŠ¡æŠ¥é…¬å°†è‡ªåŠ¨è®¡ç®—</small>
                </div>

                <div class="form-group">
                    <label>ğŸ“… æ¯æœˆåŠ³åŠ¡æŠ¥é…¬ï¼ˆå…ƒ/æœˆï¼‰</label>
                    <input type="number" id="monthlyLaborIncome" placeholder="æˆ–å¡«å†™æ¯æœˆåŠ³åŠ¡æŠ¥é…¬" oninput="onLaborMonthlyChange()">
                    <small>å¡«å†™æ¯æœˆé‡‘é¢åï¼Œæ€»é¢å°†è‡ªåŠ¨è®¡ç®—ï¼ˆÃ—12ï¼‰</small>
                </div>
                <div class="form-group">
                    <label style="color: #9b59b6;">æ¯æœˆåŠ³åŠ¡æŠ¥é…¬é¢„æ‰£é¢„ç¼´ä¸ªç¨</label>
                    <div id="monthlyLaborTaxDisplay" style="font-size: 18px; font-weight: bold; color: #9b59b6; padding: 10px 0;">0.00 å…ƒ</div>
                    <small>æŒ‰ç…§æ¯æœˆåŠ³åŠ¡æŠ¥é…¬çš„80%ä½œä¸ºåŸºæ•°è®¡ç®—é¢„æ‰£é¢„ç¼´ä¸ªç¨</small>
                </div>

                <h2 class="section-title">ä¸“é¡¹é™„åŠ æ‰£é™¤</h2>
                <small style="display: block; margin-bottom: 15px; color: #666;">æ¯æœˆå¯æ‰£é™¤é‡‘é¢ï¼ˆå…ƒï¼‰</small>

                <div class="deduction-item">
                    <div class="deduction-field">
                        <span class="field-label">ğŸ‘¶ å­å¥³æ•™è‚²</span>
                        <div class="deduction-field-wrapper">
                            <input type="number" id="deduction_child" placeholder="é‡‘é¢" value="0" onchange="calculate(); updateTotalDeductionDisplay();">
                            <div class="deduction-hint">æ ‡å‡†ï¼š2000å…ƒ/æœˆÂ·å­å¥³ï¼ˆ2023å¹´èµ·æé«˜ï¼‰</div>
                            <div class="deduction-hint">çˆ¶æ¯ä¸€æ–¹100%æ‰£é™¤æˆ–åŒæ–¹å„50%æ‰£é™¤</div>
                        </div>
                    </div>
                    <div class="deduction-field">
                        <span class="field-label">ğŸ‘´ èµ¡å…»è€äºº</span>
                        <div class="deduction-field-wrapper">
                            <input type="number" id="deduction_elder" placeholder="é‡‘é¢" value="0" onchange="calculate(); updateTotalDeductionDisplay();">
                            <div class="deduction-hint">ç‹¬ç”Ÿå­å¥³3000å…ƒ/æœˆï¼ˆ2023å¹´èµ·æé«˜ï¼‰</div>
                            <div class="deduction-hint">éç‹¬ç”Ÿå…„å¼Ÿå§å¦¹åˆ†æ‘Š3000å…ƒ/æœˆï¼Œæ¯äººâ‰¤1500å…ƒ</div>
                        </div>
                    </div>
                </div>
                <div class="deduction-item">
                    <div class="deduction-field">
                        <span class="field-label">ğŸ“š ç»§ç»­æ•™è‚²</span>
                        <div class="deduction-field-wrapper">
                            <input type="number" id="deduction_education" placeholder="é‡‘é¢" value="0" onchange="calculate(); updateTotalDeductionDisplay();">
                            <div class="deduction-hint">å­¦å†ï¼ˆå­¦ä½ï¼‰æ•™è‚²400å…ƒ/æœˆï¼Œé™48ä¸ªæœˆ</div>
                            <div class="deduction-hint">èŒä¸šèµ„æ ¼è¯ä¹¦3600å…ƒ/å¹´ï¼Œå–å¾—è¯ä¹¦å½“å¹´</div>
                        </div>
                    </div>
                    <div class="deduction-field">
                        <span class="field-label">ğŸ  ä½æˆ¿è´·æ¬¾åˆ©æ¯</span>
                        <div class="deduction-field-wrapper">
                            <input type="number" id="deduction_housing" placeholder="é‡‘é¢" value="0" oninput="onHousingInputChange()" onchange="updateTotalDeductionDisplay();">
                            <div class="deduction-hint">æ ‡å‡†ï¼š1000å…ƒ/æœˆï¼ˆé¦–å¥—ä½æˆ¿è´·æ¬¾åˆ©æ¯ï¼‰</div>
                            <div class="deduction-hint">å¤«å¦»åŒæ–¹çº¦å®šç”±ä¸€æ–¹æ‰£é™¤ï¼Œå„è‡ª50%</div>
                        </div>
                    </div>
                </div>
                <div class="deduction-item">
                    <div class="deduction-field">
                        <span class="field-label">ğŸ”‘ ä½æˆ¿ç§Ÿé‡‘</span>
                        <div class="deduction-field-wrapper">
                            <input type="number" id="deduction_rent" placeholder="é‡‘é¢" value="0" oninput="onRentInputChange()" onchange="updateTotalDeductionDisplay();">
                            <div class="deduction-hint">ç›´è¾–å¸‚/çœä¼š/è®¡åˆ’å•åˆ—å¸‚1500å…ƒ/æœˆ</div>
                            <div class="deduction-hint">äººå£>100ä¸‡åŸå¸‚1100å…ƒ/æœˆï¼Œâ‰¤100ä¸‡800å…ƒ/æœˆ</div>
                        </div>
                    </div>
                    <div class="deduction-field">
                        <span class="field-label">ğŸ¥ å¤§ç—…åŒ»ç–—</span>
                        <div class="deduction-field-wrapper">
                            <input type="number" id="deduction_medical" placeholder="é‡‘é¢" value="0" onchange="calculate(); updateTotalDeductionDisplay();">
                            <div class="deduction-hint">åŒ»ä¿æŠ¥é”€åè‡ªä»˜è¶…15000å…ƒéƒ¨åˆ†æ‰£é™¤</div>
                            <div class="deduction-hint">å¹´åº¦é™é¢80000å…ƒï¼Œæ±‡ç®—æ¸…ç¼´æ—¶æ®å®æ‰£é™¤</div>
                        </div>
                    </div>
                </div>
                <div class="deduction-item">
                    <div class="deduction-field">
                        <span class="field-label">ğŸ‘¶ 3å²ä»¥ä¸‹å©´å¹¼å„¿</span>
                        <div class="deduction-field-wrapper">
                            <input type="number" id="deduction_3child" placeholder="é‡‘é¢" value="0" onchange="calculate(); updateTotalDeductionDisplay();">
                            <div class="deduction-hint">æ ‡å‡†ï¼š2000å…ƒ/æœˆÂ·å©´å¹¼å„¿ï¼ˆ2023å¹´èµ·æé«˜ï¼‰</div>
                            <div class="deduction-hint">çˆ¶æ¯ä¸€æ–¹100%æ‰£é™¤æˆ–åŒæ–¹å„50%æ‰£é™¤</div>
                        </div>
                    </div>
                </div>

                <div class="warning-alert" id="housingWarning">
                    <div class="warning-title">âš ï¸ é‡è¦æç¤º</div>
                    <div class="warning-text">ä½æˆ¿è´·æ¬¾åˆ©æ¯å’Œä½æˆ¿ç§Ÿé‡‘æ‰£é™¤ä¸èƒ½åŒæ—¶äº«å—ï¼Œåªèƒ½äºŒé€‰ä¸€ã€‚è¯·æ£€æŸ¥æ‚¨çš„å¡«å†™æ˜¯å¦æ­£ç¡®ã€‚</div>
                </div>

                <button class="btn-reset" onclick="resetForm()" style="position: absolute; top: 20px; right: 20px; padding: 8px 16px; margin: 0;">â†º é‡ç½®</button>
            </div>

            <div class="result-section">
                <h2 class="section-title">è®¡ç®—ç»“æœ</h2>

                <div class="result-card">
                    <div class="label">ç¨åæœˆè–ª</div>
                    <div class="value" id="netSalary">0</div>
                    <div class="unit">å…ƒ/æœˆ</div>
                </div>

                <div class="effective-rate">
                    <div class="rate" id="effectiveRate">0%</div>
                    <div class="text">ç»¼åˆç¨ç‡ï¼ˆä¸ªç¨+äº”é™©ä¸€é‡‘å æ”¶å…¥æ¯”ä¾‹ï¼‰</div>
                </div>

                <h2 class="section-title" style="margin-top: 25px;">æœˆæ”¶å…¥æ˜ç»†</h2>

                <div class="detail-item total-highlight">
                    <span class="label">ç¨å‰æœˆè–ª</span>
                    <span class="value" id="detail_gross">0</span>
                </div>
                <div class="detail-item">
                    <span class="label">å…»è€ä¿é™© (8%)</span>
                    <span class="value" id="detail_pension">0</span>
                </div>
                <div class="detail-item">
                    <span class="label">åŒ»ç–—ä¿é™© (2%)</span>
                    <span class="value" id="detail_medical">0</span>
                </div>
                <div class="detail-item">
                    <span class="label">å¤±ä¸šä¿é™© (0.5%)</span>
                    <span class="value" id="detail_unemployment">0</span>
                </div>
                <div class="detail-item">
                    <span class="label">ä½æˆ¿å…¬ç§¯é‡‘</span>
                    <span class="value" id="detail_fund">0</span>
                </div>
                <div class="detail-item">
                    <span class="label">ä¸“é¡¹é™„åŠ æ‰£é™¤</span>
                    <span class="value" id="detail_deduction">0</span>
                </div>
                <div class="detail-item">
                    <span class="label">è‡³ä¸Šæœˆä¸ªç¨é¢„æ‰£é¢„ç¼´</span>
                    <span class="value" id="detail_tax_prev_month">0</span>
                </div>
                <div class="detail-item total-highlight">
                    <span class="label">å½“æœˆè–ªé‡‘ä¸ªäººæ‰€å¾—ç¨</span>
                    <span class="value" id="detail_tax">0</span>
                </div>
                <div class="detail-item total-highlight">
                    <span class="label">äº”é™©ä¸€é‡‘åˆè®¡</span>
                    <span class="value" id="detail_social_total">0</span>
                </div>
                <div class="detail-item total-highlight">
                    <span class="label">ç¨åæœˆè–ª</span>
                    <span class="value" id="detail_net">0</span>
                </div>
                <div class="detail-item total">
                    <span class="label">ç¨åå¹´è–ªï¼ˆä¸å«å¹´ç»ˆä¸€æ¬¡æ€§å¥–é‡‘ï¼‰</span>
                    <span class="value" id="year_net_salary_no_bonus">0</span>
                </div>

                <h2 class="section-title" style="margin-top: 25px;">å¹´åº¦æ±‡æ€»</h2>

                <div class="detail-item total-year-amount">
                    <span class="label">å¹´åº¦ç¨å‰æ”¶å…¥æ€»é¢</span>
                    <span class="value" id="year_gross">0</span>
                </div>
                <div class="detail-item">
                    <span class="label">å…¶ä¸­ï¼šå¹´è–ªæ”¶å…¥</span>
                    <span class="value" id="year_salary_gross">0</span>
                </div>
                <div class="detail-item" id="yearLaborDetail" style="display: none;">
                    <span class="label">å…¶ä¸­ï¼šåŠ³åŠ¡æŠ¥é…¬æ”¶å…¥</span>
                    <span class="value" id="year_labor_gross">0</span>
                </div>
                <div class="detail-item" id="yearLaborDeductDetail" style="display: none; background: #f0f8ff;">
                    <span class="label">åŠ³åŠ¡æŠ¥é…¬è´¹ç”¨æ‰£é™¤ï¼ˆ20%ï¼‰</span>
                    <span class="value" id="year_labor_deduct">0</span>
                </div>
                <div class="detail-item" id="yearLaborNetDetail" style="display: none; background: #f0f8ff;">
                    <span class="label">åŠ³åŠ¡æŠ¥é…¬è®¡å…¥ç»¼åˆæ‰€å¾—ï¼ˆ80%ï¼‰</span>
                    <span class="value" id="year_labor_net">0</span>
                </div>
                <div class="detail-item" id="yearBonusDetail" style="display: none;">
                    <span class="label">å…¶ä¸­ï¼šå¹´ç»ˆå¥–æ”¶å…¥</span>
                    <span class="value" id="year_bonus_gross">0</span>
                </div>
                <div class="detail-item" style="background: #fff3cd;">
                    <span class="label">åŸºæœ¬å‡é™¤è´¹ç”¨</span>
                    <span class="value">60,000</span>
                </div>
                <div class="detail-item">
                    <span class="label">äº”é™©ä¸€é‡‘åˆè®¡ï¼ˆå¹´åº¦ï¼‰</span>
                    <span class="value" id="year_social_deduction">0</span>
                </div>
                <div class="detail-item">
                    <span class="label">ä¸“é¡¹é™„åŠ æ‰£é™¤åˆè®¡ï¼ˆå¹´åº¦ï¼‰</span>
                    <span class="value" id="year_special_deduction">0</span>
                </div>
                <div class="detail-item total">
                    <span class="label">å¹´åº¦åº”çº³ç¨æ‰€å¾—é¢</span>
                    <span class="value" id="year_taxable_income">0</span>
                </div>
                <div class="detail-item total-year-amount">
                    <span class="label">å¹´åº¦ä¸ªç¨æ€»é¢</span>
                    <span class="value" id="year_tax">0</span>
                </div>
                <div class="detail-item" id="yearBonusTaxDetail" style="display: none;">
                    <span class="label">å…¶ä¸­ï¼šå¹´ç»ˆå¥–ä¸ªç¨</span>
                    <span class="value" id="year_bonus_tax">0</span>
                </div>
                <div class="detail-item total-year-amount">
                    <span class="label">å¹´åº¦ç¨åæ”¶å…¥</span>
                    <span class="value" id="year_net">0</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æœˆåº¦ç¨ç‡è¡¨ï¼ˆç”¨äºæœˆè–ªä¸ªç¨è®¡ç®—ï¼‰
        const monthlyTaxBrackets = [
            { limit: 3000, rate: 0.03, deduction: 0 },
            { limit: 12000, rate: 0.10, deduction: 210 },
            { limit: 25000, rate: 0.20, deduction: 1410 },
            { limit: 35000, rate: 0.25, deduction: 2660 },
            { limit: 55000, rate: 0.30, deduction: 4410 },
            { limit: 80000, rate: 0.35, deduction: 7160 },
            { limit: Infinity, rate: 0.45, deduction: 15160 }
        ];

        // å¹´åº¦ä¸ªäººæ‰€å¾—ç¨ç¨ç‡è¡¨ï¼ˆç»¼åˆæ‰€å¾—é€‚ç”¨ï¼‰
        // æ¥æºï¼šä¸ªäººæ‰€å¾—ç¨ç¨ç‡è¡¨ï¼ˆç»¼åˆæ‰€å¾—é€‚ç”¨ï¼‰
        const yearlyTaxBrackets = [
            { limit: 36000, rate: 0.03, deduction: 0 },
            { limit: 144000, rate: 0.10, deduction: 2520 },
            { limit: 300000, rate: 0.20, deduction: 16920 },
            { limit: 420000, rate: 0.25, deduction: 31920 },
            { limit: 660000, rate: 0.30, deduction: 52920 },
            { limit: 960000, rate: 0.35, deduction: 85920 },
            { limit: Infinity, rate: 0.45, deduction: 181920 }
        ];

        // å¹´ç»ˆå¥–ç¨ç‡è¡¨ï¼ˆå•ç‹¬è®¡ç¨é€‚ç”¨ï¼‰
        const bonusTaxBrackets = [
            { limit: 3000, rate: 0.03, deduction: 0 },
            { limit: 12000, rate: 0.10, deduction: 210 },
            { limit: 25000, rate: 0.20, deduction: 1410 },
            { limit: 35000, rate: 0.25, deduction: 2660 },
            { limit: 55000, rate: 0.30, deduction: 4410 },
            { limit: 80000, rate: 0.35, deduction: 7160 },
            { limit: Infinity, rate: 0.45, deduction: 15160 }
        ];

        function toggleSalaryType() {
            const isMonth = document.querySelector('input[name="salaryType"]:checked').value === 'month';
            document.getElementById('monthSalaryGroup').style.display = isMonth ? 'block' : 'none';
            document.getElementById('yearSalaryGroup').style.display = isMonth ? 'none' : 'block';
            // è§¦å‘é‡æ–°è®¡ç®—ï¼Œç¡®ä¿æ˜¾ç¤ºåŠæ—¶æ›´æ–°
            calculate();
        }

        // åŠ³åŠ¡æŠ¥é…¬æ€»é¢æ”¹å˜æ—¶çš„å¤„ç†
        function onLaborTotalChange() {
            const totalIncome = document.getElementById('laborIncome');
            const monthlyInput = document.getElementById('monthlyLaborIncome');

            if (totalIncome.value && totalIncome.value !== '') {
                const monthly = parseFloat(totalIncome.value) / 12;
                monthlyInput.value = monthly.toFixed(2);
                monthlyInput.disabled = true;
            } else {
                monthlyInput.value = '';
                monthlyInput.disabled = false;
            }
            updateLaborWithholdingTaxDisplay();
            // è§¦å‘å®Œæ•´è®¡ç®—ï¼Œæ›´æ–°å¹´åº¦æ±‡æ€»
            calculate();
        }

        // æ¯æœˆåŠ³åŠ¡æŠ¥é…¬æ”¹å˜æ—¶çš„å¤„ç†
        function onLaborMonthlyChange() {
            const monthlyIncome = document.getElementById('monthlyLaborIncome');
            const totalInput = document.getElementById('laborIncome');

            if (monthlyIncome.value && monthlyIncome.value !== '') {
                const total = parseFloat(monthlyIncome.value) * 12;
                totalInput.value = total.toFixed(2);
                totalInput.disabled = true;
            } else {
                totalInput.value = '';
                totalInput.disabled = false;
            }
            updateLaborWithholdingTaxDisplay();
            // è§¦å‘å®Œæ•´è®¡ç®—ï¼Œæ›´æ–°å¹´åº¦æ±‡æ€»
            calculate();
        }

        // ä½æˆ¿è´·æ¬¾åˆ©æ¯è¾“å…¥å˜åŒ–æ—¶ï¼Œæ¸…ç©ºä½æˆ¿ç§Ÿé‡‘
        function onHousingInputChange() {
            const housingInput = document.getElementById('deduction_housing');
            const rentInput = document.getElementById('deduction_rent');

            if (housingInput.value && housingInput.value !== '' && parseFloat(housingInput.value) > 0) {
                rentInput.value = '';
            }
            checkHousingConflict();
        }

        // ä½æˆ¿ç§Ÿé‡‘è¾“å…¥å˜åŒ–æ—¶ï¼Œæ¸…ç©ºä½æˆ¿è´·æ¬¾åˆ©æ¯
        function onRentInputChange() {
            const rentInput = document.getElementById('deduction_rent');
            const housingInput = document.getElementById('deduction_housing');

            if (rentInput.value && rentInput.value !== '' && parseFloat(rentInput.value) > 0) {
                housingInput.value = '';
            }
            checkHousingConflict();
        }

        // æ£€æŸ¥ä½æˆ¿è´·æ¬¾åˆ©æ¯å’Œä½æˆ¿ç§Ÿé‡‘å†²çª
        function checkHousingConflict() {
            const deduction_housing = parseFloat(document.getElementById('deduction_housing').value) || 0;
            const deduction_rent = parseFloat(document.getElementById('deduction_rent').value) || 0;

            // è°ƒç”¨è®¡ç®—å‡½æ•°ä»¥æ›´æ–°è­¦å‘Šæç¤º
            calculate();
        }

        function formatMoney(num) {
            return num.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }

        // è®¡ç®—åŠ³åŠ¡æŠ¥é…¬é¢„æ‰£é¢„ç¼´ä¸ªç¨
        function calculateLaborWithholdingTax(monthlyLaborIncome) {
            if (!monthlyLaborIncome || monthlyLaborIncome <= 0) return 0;

            // æŒ‰ç…§æ¯æœˆåŠ³åŠ¡æŠ¥é…¬çš„80%ä½œä¸ºåŸºæ•°
            const taxableAmount = monthlyLaborIncome * 0.8;

            let taxRate;
            let quickDeduction;

            // åŠ³åŠ¡æŠ¥é…¬é¢„æ‰£ç‡è¡¨äºŒ
            if (taxableAmount <= 20000) {
                taxRate = 0.20;
                quickDeduction = 0;
            } else if (taxableAmount <= 50000) {
                taxRate = 0.30;
                quickDeduction = 2000;
            } else {
                taxRate = 0.40;
                quickDeduction = 7000;
            }

            return taxableAmount * taxRate - quickDeduction;
        }

        // æ›´æ–°åŠ³åŠ¡æŠ¥é…¬é¢„æ‰£é¢„ç¼´ä¸ªç¨æ˜¾ç¤º
        function updateLaborWithholdingTaxDisplay() {
            const monthlyLaborIncome = parseFloat(document.getElementById('monthlyLaborIncome').value) || 0;
            const tax = calculateLaborWithholdingTax(monthlyLaborIncome);
            document.getElementById('monthlyLaborTaxDisplay').textContent = formatMoney(tax) + ' å…ƒ';
        }

        // æ›´æ–°ä¸“é¡¹é™„åŠ æ‰£é™¤æ€»é¢æ˜¾ç¤º
        function updateTotalDeductionDisplay() {
            const deduction_child = parseFloat(document.getElementById('deduction_child').value) || 0;
            const deduction_elder = parseFloat(document.getElementById('deduction_elder').value) || 0;
            const deduction_education = parseFloat(document.getElementById('deduction_education').value) || 0;
            const deduction_housing = parseFloat(document.getElementById('deduction_housing').value) || 0;
            const deduction_rent = parseFloat(document.getElementById('deduction_rent').value) || 0;
            const deduction_medical = parseFloat(document.getElementById('deduction_medical').value) || 0;
            const deduction_3child = parseFloat(document.getElementById('deduction_3child').value) || 0;

            const totalSpecialDeduction = deduction_child + deduction_elder + deduction_education +
                                         deduction_housing + deduction_rent + deduction_medical + deduction_3child;

            // ä¸“é¡¹é™„åŠ æ‰£é™¤æ€»é¢ä¸å†æ˜¾ç¤ºåœ¨å·¦ä¾§é¢æ¿
            // document.getElementById('totalDeductionDisplay').textContent = formatMoney(totalSpecialDeduction);
        }

        // è®¡ç®—ç´¯è®¡é¢„æ‰£é¢„ç¼´ç¨é¢ï¼ˆæŒ‰å¹´åº¦ç¨ç‡è¡¨ï¼‰
        function calculateCumulativeTax(cumulativeTaxableIncome) {
            if (cumulativeTaxableIncome <= 0) return 0;

            for (const bracket of yearlyTaxBrackets) {
                if (cumulativeTaxableIncome <= bracket.limit) {
                    return cumulativeTaxableIncome * bracket.rate - bracket.deduction;
                }
            }
            return 0;
        }

        // è®¡ç®—æœˆåº¦ä¸ªç¨ï¼ˆä½¿ç”¨æœˆåº¦ç¨ç‡è¡¨ï¼‰- ä¿ç•™ç”¨äºå…¼å®¹
        function calculateMonthlyTax(taxableIncome) {
            if (taxableIncome <= 0) return 0;

            for (const bracket of monthlyTaxBrackets) {
                if (taxableIncome <= bracket.limit) {
                    return taxableIncome * bracket.rate - bracket.deduction;
                }
            }
            return 0;
        }

        // è®¡ç®—å¹´åº¦ä¸ªç¨ï¼ˆä½¿ç”¨å¹´åº¦ç¨ç‡è¡¨ï¼‰
        function calculateYearlyTax(taxableIncome) {
            if (taxableIncome <= 0) return 0;

            for (const bracket of yearlyTaxBrackets) {
                if (taxableIncome <= bracket.limit) {
                    return taxableIncome * bracket.rate - bracket.deduction;
                }
            }
            return 0;
        }

        // å…¼å®¹æ—§å‡½æ•°å
        function calculateTax(taxableIncome) {
            return calculateMonthlyTax(taxableIncome);
        }

        // è®¡ç®—å¹´ç»ˆå¥–å•ç‹¬è®¡ç¨
        function calculateBonusTaxSeparate(bonus) {
            if (bonus <= 0) return 0;

            const monthlyBonus = bonus / 12;

            for (const bracket of bonusTaxBrackets) {
                if (monthlyBonus <= bracket.limit) {
                    return bonus * bracket.rate - bracket.deduction;
                }
            }
            return 0;
        }

        // è®¡ç®—åŠ³åŠ¡æŠ¥é…¬ä¸ªç¨
        function calculateLaborTax(laborIncome, yearlyTaxableIncome, totalTaxableIncome) {
            if (laborIncome <= 0) return { monthlyTax: 0, yearlyTax: 0, effectiveTax: 0 };

            let deductAmount;
            if (laborIncome <= 4000) {
                deductAmount = 800;
            } else {
                deductAmount = laborIncome * 0.2;
            }

            const taxableAmount = laborIncome - deductAmount;

            if (taxableAmount <= 0) return { monthlyTax: 0, yearlyTax: 0, effectiveTax: 0 };

            let taxRate;
            if (taxableAmount <= 20000) {
                taxRate = 0.20;
            } else if (taxableAmount <= 50000) {
                taxRate = 0.30;
            } else {
                taxRate = 0.40;
            }

            const monthlyWithholdingTax = taxableAmount * taxRate;

            const laborYearlyDeduct = laborIncome * 0.2;
            const laborYearlyTaxable = laborIncome - laborYearlyDeduct;

            const totalYearlyTaxable = totalTaxableIncome + laborYearlyTaxable;
            const totalYearlyTax = calculateTax(totalYearlyTaxable);
            const baseYearlyTax = calculateTax(totalTaxableIncome);

            const laborYearlyTax = totalYearlyTax - baseYearlyTax;

            return {
                monthlyTax: monthlyWithholdingTax,
                yearlyTax: laborYearlyTax > 0 ? laborYearlyTax : 0,
                effectiveTax: laborYearlyTax > 0 ? laborYearlyTax : 0
            };
        }

        function calculate() {
            const isMonth = document.querySelector('input[name="salaryType"]:checked').value === 'month';

            let monthlySalary;
            if (isMonth) {
                monthlySalary = parseFloat(document.getElementById('monthlySalary').value) || 0;
            } else {
                const yearlySalary = parseFloat(document.getElementById('yearlySalary').value) || 0;
                monthlySalary = yearlySalary / 12;
            }

            // ç¤¾ä¿ç¼´è´¹åŸºæ•°ï¼šç•™ç©ºåˆ™ç­‰äºæœˆè–ªï¼Œå¹¶æ˜¾ç¤ºå…·ä½“æ•°å€¼
            let socialBase;
            let socialBaseDisplay;
            const socialBaseInput = document.getElementById('socialBase');
            if (!socialBaseInput.value || socialBaseInput.value === '') {
                socialBase = monthlySalary;
                socialBaseDisplay = socialBase;
                // æ˜¾ç¤ºå…·ä½“æ•°å€¼è€Œä¸æ˜¯å ä½ç¬¦
                socialBaseInput.value = socialBase > 0 ? socialBase.toFixed(2) : '';
            } else {
                socialBase = parseFloat(socialBaseInput.value);
                socialBaseDisplay = socialBase;
            }

            // å…¬ç§¯é‡‘ç¼´è´¹åŸºæ•°ï¼šç•™ç©ºåˆ™ç­‰äºç¤¾ä¿åŸºæ•°ï¼Œå¹¶æ˜¾ç¤ºå…·ä½“æ•°å€¼
            let fundBase;
            let fundBaseDisplay;
            const fundBaseInput = document.getElementById('fundBase');
            if (!fundBaseInput.value || fundBaseInput.value === '') {
                fundBase = socialBase;
                fundBaseDisplay = socialBaseDisplay;
                // æ˜¾ç¤ºå…·ä½“æ•°å€¼è€Œä¸æ˜¯å ä½ç¬¦
                fundBaseInput.value = fundBase > 0 ? fundBase.toFixed(2) : '';
            } else {
                fundBase = parseFloat(fundBaseInput.value);
                fundBaseDisplay = fundBase;
            }

            // å…¬ç§¯é‡‘æ¯”ä¾‹ï¼šç•™ç©ºåˆ™é»˜è®¤12%ï¼Œå¹¶æ˜¾ç¤ºå…·ä½“æ•°å€¼
            let fundRate;
            const fundRateInput = document.getElementById('fundRate');
            if (!fundRateInput.value || fundRateInput.value === '') {
                fundRate = 0.12;
                // æ˜¾ç¤ºå…·ä½“æ•°å€¼è€Œä¸æ˜¯å ä½ç¬¦
                fundRateInput.value = '12';
            } else {
                fundRate = parseFloat(fundRateInput.value) / 100;
            }

            const deduction_child = parseFloat(document.getElementById('deduction_child').value) || 0;
            const deduction_elder = parseFloat(document.getElementById('deduction_elder').value) || 0;
            const deduction_education = parseFloat(document.getElementById('deduction_education').value) || 0;
            const deduction_housing = parseFloat(document.getElementById('deduction_housing').value) || 0;
            const deduction_rent = parseFloat(document.getElementById('deduction_rent').value) || 0;
            const deduction_medical = parseFloat(document.getElementById('deduction_medical').value) || 0;
            const deduction_3child = parseFloat(document.getElementById('deduction_3child').value) || 0;

            const totalSpecialDeduction = deduction_child + deduction_elder + deduction_education +
                                         deduction_housing + deduction_rent + deduction_medical + deduction_3child;

            const pension = socialBase * 0.08;
            const medical = socialBase * 0.02;
            const unemployment = socialBase * 0.005;
            const fund = fundBase * fundRate;

            const socialTotal = pension + medical + unemployment + fund;

            const yearEndBonus = parseFloat(document.getElementById('yearEndBonus').value) || 0;
            const bonusTaxMethod = document.querySelector('input[name="bonusTaxMethod"]:checked').value;

            const laborIncomeYearly = parseFloat(document.getElementById('laborIncome').value) || 0;
            const laborIncomeMonthly = parseFloat(document.getElementById('monthlyLaborIncome').value) || 0;

            const threshold = 5000;
            const currentMonth = parseInt(document.getElementById('currentMonth').value);

            const yearlySalary = monthlySalary * 12;
            const yearlySocialTotal = socialTotal * 12;
            const yearlySpecialDeduction = totalSpecialDeduction * 12;

            // åŠ³åŠ¡æŠ¥é…¬æŒ‰80%è®¡å…¥ç»¼åˆæ‰€å¾—ï¼ˆæ‰£é™¤20%è´¹ç”¨ï¼‰
            const laborYearlyTaxable = laborIncomeYearly * 0.8;

            // ç´¯è®¡é¢„æ‰£é¢„ç¼´æ³•è®¡ç®—ä¸ªç¨
            // è‡³å½“æœˆç´¯è®¡åº”çº³ç¨æ‰€å¾—é¢ = ç´¯è®¡æ”¶å…¥ - ç´¯è®¡å‡é™¤è´¹ç”¨ - ç´¯è®¡ä¸“é¡¹é™„åŠ æ‰£é™¤ - ç´¯è®¡äº”é™©ä¸€é‡‘
            const cumulativeTaxableIncome = Math.max(0, monthlySalary * currentMonth - threshold * currentMonth - socialTotal * currentMonth - totalSpecialDeduction * currentMonth);
            const cumulativeTax = calculateCumulativeTax(cumulativeTaxableIncome);

            // è‡³ä¸Šæœˆç´¯è®¡åº”çº³ç¨æ‰€å¾—é¢å’Œç´¯è®¡åº”é¢„æ‰£é¢„ç¼´ç¨é¢
            let prevCumulativeTax = 0;
            if (currentMonth > 1) {
                const prevCumulativeTaxableIncome = Math.max(0, monthlySalary * (currentMonth - 1) - threshold * (currentMonth - 1) - socialTotal * (currentMonth - 1) - totalSpecialDeduction * (currentMonth - 1));
                prevCumulativeTax = calculateCumulativeTax(prevCumulativeTaxableIncome);
            }

            // å½“æœˆä¸ªç¨ = è‡³å½“æœˆç´¯è®¡åº”é¢„æ‰£é¢„ç¼´ç¨é¢ - è‡³ä¸Šæœˆç´¯è®¡å·²é¢„æ‰£é¢„ç¼´ç¨é¢
            const tax = cumulativeTax - prevCumulativeTax;

            // æœˆåº¦åº”çº³ç¨æ‰€å¾—é¢ï¼ˆä¸å«åŠ³åŠ¡æŠ¥é…¬ï¼ŒåŠ³åŠ¡æŠ¥é…¬æŒ‰å¹´åº¦å¤„ç†ï¼‰
            const monthlyTaxableIncome = Math.max(0, monthlySalary - threshold - socialTotal - totalSpecialDeduction);

            // å¹´åº¦åº”çº³ç¨æ‰€å¾—é¢ = å·¥èµ„è–ªé‡‘ + åŠ³åŠ¡æŠ¥é…¬ Ã— 80% + å¹´ç»ˆå¥– - åŸºæœ¬å‡é™¤è´¹ç”¨60000 - äº”é™©ä¸€é‡‘ - ä¸“é¡¹é™„åŠ æ‰£é™¤
            const finalYearlyTaxableIncome = Math.max(0, yearlySalary + laborYearlyTaxable + yearEndBonus - 60000 - yearlySocialTotal - yearlySpecialDeduction);

            // åŸºç¡€å¹´åº¦åº”çº³ç¨æ‰€å¾—é¢ï¼ˆä¸å«å¹´ç»ˆå¥–ï¼‰
            const baseYearlyTaxableIncome = Math.max(0, yearlySalary + laborYearlyTaxable - 60000 - yearlySocialTotal - yearlySpecialDeduction);
            const baseYearlyTax = calculateYearlyTax(baseYearlyTaxableIncome);

            let yearlyTax = baseYearlyTax;
            let bonusTax = 0;

            // å¹´ç»ˆå¥–è®¡ç¨
            if (yearEndBonus > 0) {
                if (bonusTaxMethod === 'separate') {
                    // å•ç‹¬è®¡ç¨ï¼šå¹´ç»ˆå¥–å•ç‹¬è®¡ç®—
                    bonusTax = calculateBonusTaxSeparate(yearEndBonus);
                    yearlyTax = baseYearlyTax;  // å¹´åº¦ç¨ä¿æŒä¸ºåŸºç¡€ç¨
                } else {
                    // å¹¶å…¥ç»¼åˆæ‰€å¾—ï¼šå¹´ç»ˆå¥–å¹¶å…¥ç»¼åˆæ‰€å¾—è®¡ç®—
                    yearlyTax = calculateYearlyTax(finalYearlyTaxableIncome);  // å¹´åº¦ç¨ä¸ºåŒ…å«å¹´ç»ˆå¥–çš„æ€»ç¨é¢
                    bonusTax = yearlyTax - baseYearlyTax;  // å¹´ç»ˆå¥–å¯¼è‡´å¢åŠ çš„ç¨é¢
                }
            }

            const netSalary = monthlySalary - socialTotal - tax;

            const totalMonthlyTax = tax + (bonusTax / 12);
            const effectiveRate = monthlySalary > 0 ? ((socialTotal + totalMonthlyTax) / monthlySalary * 100) : 0;

            // ä¸“é¡¹é™„åŠ æ‰£é™¤æ€»é¢ä¸å†æ˜¾ç¤ºåœ¨å·¦ä¾§é¢æ¿
            // document.getElementById('totalDeductionDisplay').textContent = formatMoney(totalSpecialDeduction);

            document.getElementById('netSalary').textContent = formatMoney(netSalary + (bonusTax > 0 ? bonusTax / 12 : 0));
            document.getElementById('effectiveRate').textContent = effectiveRate.toFixed(2) + '%';

            // ç¨åå¹´è–ªï¼ˆä¸å«å¹´ç»ˆä¸€æ¬¡æ€§å¥–é‡‘ï¼‰
            const yearNetSalaryNoBonus = netSalary * 12;
            document.getElementById('year_net_salary_no_bonus').textContent = formatMoney(yearNetSalaryNoBonus);

            document.getElementById('detail_gross').textContent = formatMoney(monthlySalary);
            document.getElementById('detail_pension').textContent = formatMoney(pension) + ` (${formatMoney(socialBaseDisplay)} Ã— 8%)`;
            document.getElementById('detail_medical').textContent = formatMoney(medical) + ` (${formatMoney(socialBaseDisplay)} Ã— 2%)`;
            document.getElementById('detail_unemployment').textContent = formatMoney(unemployment) + ` (${formatMoney(socialBaseDisplay)} Ã— 0.5%)`;
            document.getElementById('detail_fund').textContent = formatMoney(fund) + ` (${formatMoney(fundBaseDisplay)} Ã— ${(fundRate * 100).toFixed(0)}%)`;
            document.getElementById('detail_deduction').textContent = formatMoney(totalSpecialDeduction);
            document.getElementById('detail_tax_prev_month').textContent = formatMoney(prevCumulativeTax) + ` (è‡³${currentMonth - 1}æœˆç´¯è®¡)`;
            document.getElementById('detail_tax').textContent = formatMoney(tax) + ` (å½“æœˆç´¯è®¡${formatMoney(cumulativeTax)})`;
            document.getElementById('detail_social_total').textContent = formatMoney(socialTotal);
            document.getElementById('detail_net').textContent = formatMoney(netSalary);

            // å¹´åº¦åº”çº³ç¨æ‰€å¾—é¢æ˜¾ç¤º
            document.getElementById('year_taxable_income').textContent = formatMoney(finalYearlyTaxableIncome);

            document.getElementById('year_salary_gross').textContent = formatMoney(yearlySalary);

            // äº”é™©ä¸€é‡‘å’Œä¸“é¡¹é™„åŠ æ‰£é™¤ï¼ˆå¹´åº¦ï¼‰
            document.getElementById('year_social_deduction').textContent = formatMoney(yearlySocialTotal);
            document.getElementById('year_special_deduction').textContent = formatMoney(yearlySpecialDeduction);

            if (laborIncomeYearly > 0) {
                document.getElementById('yearLaborDetail').style.display = 'flex';
                document.getElementById('year_labor_gross').textContent = formatMoney(laborIncomeYearly);
                // æ˜¾ç¤ºåŠ³åŠ¡æŠ¥é…¬è´¹ç”¨æ‰£é™¤ï¼ˆ20%ï¼‰
                document.getElementById('yearLaborDeductDetail').style.display = 'flex';
                document.getElementById('year_labor_deduct').textContent = formatMoney(laborIncomeYearly * 0.2);
                // æ˜¾ç¤ºåŠ³åŠ¡æŠ¥é…¬è®¡å…¥ç»¼åˆæ‰€å¾—çš„é‡‘é¢ï¼ˆ80%ï¼‰
                document.getElementById('yearLaborNetDetail').style.display = 'flex';
                document.getElementById('year_labor_net').textContent = formatMoney(laborYearlyTaxable);
            } else {
                document.getElementById('yearLaborDetail').style.display = 'none';
                document.getElementById('yearLaborDeductDetail').style.display = 'none';
                document.getElementById('yearLaborNetDetail').style.display = 'none';
            }

            document.getElementById('year_gross').textContent = formatMoney(yearlySalary + yearEndBonus + laborIncomeYearly);

            // å¹´åº¦ä¸ªç¨æ€»é¢ï¼ˆæ ¹æ®è®¡ç¨æ–¹å¼æ˜¾ç¤ºï¼‰
            if (bonusTaxMethod === 'separate' || yearEndBonus === 0) {
                // å•ç‹¬è®¡ç¨æˆ–æ— å¹´ç»ˆå¥–ï¼šyearlyTaxå’ŒbonusTaxåˆ†åˆ«è®¡ç®—ï¼Œéœ€è¦ç›¸åŠ 
                document.getElementById('year_tax').textContent = formatMoney(yearlyTax + bonusTax);
            } else {
                // å¹¶å…¥ç»¼åˆæ‰€å¾—ï¼šyearlyTaxå·²åŒ…å«å¹´ç»ˆå¥–ç¨ï¼Œç›´æ¥æ˜¾ç¤º
                document.getElementById('year_tax').textContent = formatMoney(yearlyTax);
            }

            // æ˜¾ç¤ºå¹´ç»ˆå¥–è¯¦æƒ…
            if (yearEndBonus > 0) {
                document.getElementById('yearBonusDetail').style.display = 'flex';
                document.getElementById('year_bonus_gross').textContent = formatMoney(yearEndBonus);

                // åªæœ‰å•ç‹¬è®¡ç¨æ—¶æ‰æ˜¾ç¤ºå¹´ç»ˆå¥–ä¸ªç¨
                if (bonusTaxMethod === 'separate') {
                    document.getElementById('yearBonusTaxDetail').style.display = 'flex';
                    document.getElementById('year_bonus_tax').textContent = formatMoney(bonusTax);
                } else {
                    // å¹¶å…¥ç»¼åˆæ‰€å¾—æ—¶ä¸æ˜¾ç¤ºå•ç‹¬çš„å¹´ç»ˆå¥–ä¸ªç¨ï¼ˆå·²åŒ…å«åœ¨ç»¼åˆæ‰€å¾—ç¨ä¸­ï¼‰
                    document.getElementById('yearBonusTaxDetail').style.display = 'none';
                }
            } else {
                document.getElementById('yearBonusDetail').style.display = 'none';
                document.getElementById('yearBonusTaxDetail').style.display = 'none';
            }

            // å¹´åº¦ç¨åæ”¶å…¥
            if (bonusTaxMethod === 'separate' || yearEndBonus === 0) {
                // å•ç‹¬è®¡ç¨æˆ–æ— å¹´ç»ˆå¥–ï¼šéœ€è¦å‡å»yearlyTaxå’ŒbonusTax
                document.getElementById('year_net').textContent = formatMoney(yearlySalary + yearEndBonus + laborIncomeYearly - yearlyTax - bonusTax);
            } else {
                // å¹¶å…¥ç»¼åˆæ‰€å¾—ï¼šåªéœ€å‡å»yearlyTaxï¼ˆå·²åŒ…å«å¹´ç»ˆå¥–ç¨ï¼‰
                document.getElementById('year_net').textContent = formatMoney(yearlySalary + yearEndBonus + laborIncomeYearly - yearlyTax);
            }

            const hasHousingLoan = deduction_housing > 0;
            const hasRent = deduction_rent > 0;
            const housingWarning = document.getElementById('housingWarning');

            if (hasHousingLoan && hasRent) {
                housingWarning.classList.add('show');
            } else {
                housingWarning.classList.remove('show');
            }
        }

        function resetForm() {
            document.getElementById('monthlySalary').value = '0';
            document.getElementById('yearlySalary').value = '';

            document.getElementById('socialBase').value = '';
            document.getElementById('fundRate').value = '12';  // å…¬ç§¯é‡‘æ¯”ä¾‹ä¿æŒ12%
            document.getElementById('fundBase').value = '';

            document.getElementById('yearEndBonus').value = '0';
            document.querySelector('input[name="bonusTaxMethod"][value="separate"]').checked = true;

            document.getElementById('laborIncome').value = '';
            document.getElementById('laborIncome').disabled = false;
            document.getElementById('monthlyLaborIncome').value = '';
            document.getElementById('monthlyLaborIncome').disabled = false;

            document.getElementById('deduction_child').value = '0';
            document.getElementById('deduction_elder').value = '0';
            document.getElementById('deduction_education').value = '0';
            document.getElementById('deduction_housing').value = '0';
            document.getElementById('deduction_rent').value = '0';
            document.getElementById('deduction_medical').value = '0';
            document.getElementById('deduction_3child').value = '0';

            // é‡ç½®åé‡æ–°è®¡ç®—
            calculate();
        }

        function clearResults() {
            document.getElementById('netSalary').textContent = '0.00';
            document.getElementById('effectiveRate').textContent = '0.00%';
            document.getElementById('year_net_salary_no_bonus').textContent = '0.00';
            document.getElementById('monthlyLaborTaxDisplay').textContent = '0.00 å…ƒ';
            document.getElementById('detail_gross').textContent = '0.00';
            document.getElementById('detail_pension').textContent = '0.00';
            document.getElementById('detail_medical').textContent = '0.00';
            document.getElementById('detail_unemployment').textContent = '0.00';
            document.getElementById('detail_fund').textContent = '0.00';
            document.getElementById('detail_deduction').textContent = '0.00';
            document.getElementById('detail_tax_prev_month').textContent = '0.00';
            document.getElementById('detail_tax').textContent = '0.00';
            document.getElementById('detail_social_total').textContent = '0.00';
            document.getElementById('detail_net').textContent = '0.00';
            document.getElementById('year_gross').textContent = '0.00';
            document.getElementById('year_salary_gross').textContent = '0.00';
            document.getElementById('year_tax').textContent = '0.00';
            document.getElementById('year_net').textContent = '0.00';
            document.getElementById('year_taxable_income').textContent = '0.00';
            document.getElementById('year_social_deduction').textContent = '0.00';
            document.getElementById('year_special_deduction').textContent = '0.00';
            // ä¸“é¡¹é™„åŠ æ‰£é™¤æ€»é¢ä¸å†æ˜¾ç¤ºåœ¨å·¦ä¾§é¢æ¿
            // document.getElementById('totalDeductionDisplay').textContent = '0.00';

            document.getElementById('yearLaborDetail').style.display = 'none';
            document.getElementById('yearLaborDeductDetail').style.display = 'none';
            document.getElementById('yearLaborNetDetail').style.display = 'none';
            document.getElementById('yearBonusDetail').style.display = 'none';
            document.getElementById('yearBonusTaxDetail').style.display = 'none';
        }

        // é¡µé¢åŠ è½½æ—¶ï¼Œä½¿ç”¨é»˜è®¤å€¼è¿›è¡Œåˆå§‹è®¡ç®—
        calculate();
    </script>
</body>
</html>
